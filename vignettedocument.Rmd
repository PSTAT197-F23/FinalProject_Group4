---
title: "Clustering Methods"
author: "Manuri Alwis, Kayla Katakis, Kylie Maeda, Jennifer Rink, Jade Thai"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Objectives

-   Explore two different clustering methods: K-means and \_\_\_\_\_\_

-   Use these clustering methods to analyze California housing data

# **K-means clustering**

K-means clustering is one of the simplest and most popular unsupervised machine learning algorithms. The objective of k-means is to group similar data points together (into clusters) and find underlying patterns. In order to do so, this algorithm looks for a fixed number of clusters in the data. The "k" in k-means refers to the number of clusters. You will define the target number k, which represents the number of centroids you want in the data. The centroid is the center of the cluster. Every data point is assigned to a cluster through reducing the in-cluster sum of squares. Basically, the k-means algorithm finds k centroids and assigns each data point the nearest cluster, while keeping the centroids as small as possible. The "means" in k-means refers to averaging of the data.

Before diving into clustering, the data must be loaded in along with any necessary packages.

```{r message=FALSE}
# load packages
library(tidyverse)
```

```{r}
# read in data
housing <- read.csv('data/housing.csv', header = TRUE)
head(housing)

# normalize data
housing_norm <- scale(housing)
head(housing_norm)
```

```{r fig.height= 7, fig.width = 7}
# initialize list of inertias (TSS within)
inertias <- c()

# get inertias for different values of k
set.seed(888)
for (k in 1:15) {
  model <- kmeans(housing_norm, centers = k)
  inertias <- c(inertias, model$tot.withinss)
}

# plot inertia against k
ggplot() +
  geom_line(aes(x = 1:15, y = inertias)) +
  geom_point(aes(x = 1:15, y = inertias)) +
  labs(title = "Elbow Method Plot", x = "Number of Clusters (k)", y = "Inertia")
```

```{r}
# perform k-means clustering with k = 5
kmeans <- kmeans(housing_norm, 5)
```

```{r}
# append cluster assignments to the data
housing$cluster <- kmeans$cluster
```

Now, we should take a look at the centroids of each cluster. A centroid is the mean of data points assigned to a cluster. Analyzing the centroids can help us understand the composition of each cluster and how they differ from each other.

```{r}
# display the centroids of each cluster
kmeans$centers
```

Based on the centroids we can loosely infer:

- Cluster 1 seems to group data points with highest `Latitude`, lowest `MedHouseVal`, and relatively low `House Age`. In other words, cluster 1 primarily consists of houses in northern California that tend to be lower in value and age.

- Cluster 2 appears to group points with high `Latitude`, high `HouseAge`, and low `Population` - that is, the least populated, oldest, northern California homes.

- Cluster 3 consists of homes that are the furthest south and relatively low in value. This cluster also has the lowest household median income.

- Cluster 4 contains homes that are typically newest in age and in the most heavily populated areas.

- Cluster 5 groups households with the highest median income, house value, and number of rooms.

Now, let's plot the data using different variables and observe how they are grouped in their clusters. We want to pick variables that show the greatest separation between clusters for visualization purposes.

```{r fig.height= 7, fig.width = 7}
# plot median income against population
ggplot(housing, aes(MedInc, log(Population), color = factor(cluster))) +
  geom_point()
```

The plot above shows the median income plotted against population. We see significant separation of clusters 4 and 5, as cluster 4 has large population values and cluster 5 has large household median income.

Since our data contains latitude and longitude variables, we can actually plot a map of California to visualize where our clusters lie.

```{r fig.height= 7, fig.width = 7}
# clusters on map of california
ggplot(housing, aes(Longitude, Latitude, color = factor(cluster))) +
  geom_point() +
  labs(title = 'Clusters on map of California', color = 'Cluster')
```

The plot shows us that our clusters largely resemble geographic and economic regions in California. For example, cluster 5 appears to contain more wealthy, populated regions like the San Fransisco, Los Angeles, and San Diego.
